<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <style>
        .flex {
            display: flex;
        }

        .flex-1 {
            flex: 1;
        }

        * {
            font-size: 22px;
        }

        .clickable {
            cursor: pointer;
        }

        .form-item {
            margin: 11px;
        }

        body {
            overflow: auto;
        }
    </style>
</head>

<body>
    <div id="app">
        <form id="form">
            <div class="flex form-item">
                <div>下载地址：</div>
                <div class="flex-1">
                    <div>
                        <input name="url" style="width: 100%; display: block;" />
                    </div>
                </div>
            </div>
            <div class="flex form-item">
                <div>下载类型：</div>
                <div>
                    <select name="type">
                        <option label="整个项目" value="1"></option>
                        <option label="项目分组" value="2" selected></option>
                        <option label="单张图片" value="3"></option>
                    </select>
                </div>
            </div>
            <div class="flex form-item">
                <div>分组组名：</div>
                <div>
                    <input name="sectorName" />
                </div>
            </div>
            <div class="flex form-item">
                <div>图片大小：</div>
                <div>
                    <select name="downloadScale">
                        <option label="1倍图" value="1" selected></option>
                        <option label="2倍图" value="2"></option>
                    </select>
                </div>
            </div>
            <div class="flex form-item">
                <div>调整尺寸：</div>
                <div>
                    <input name="resizeScale" type="number" value="1" min="0.1" max="1" />
                </div>
            </div>
            <div class="flex form-item">
                <div>启用翻译：</div>
                <div>
                    <input name="enableTranslation" type="checkbox" id="enableTranslation" checked value="1" />
                    <label class="clickable" for="enableTranslation">启用</label>
                </div>
            </div>
            <div class="flex form-item">
                <div>下载目录：</div>
                <div>
                    <input disabled name="targetFolder" style="width: 60vw;" />
                </div>
            </div>
            <div>
                <button type="button" id="submit">下载图片</button>
            </div>
        </form>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <!-- <script src="https://unpkg.com/eruda"></script> -->
    <script>eruda.init();</script>

    <script>
        const vscode = acquireVsCodeApi();
        function postMessageToVSCode(msg) {
            console.log("webview post message to vs:", msg);
            // const vscode = acquireVsCodeApi();
            vscode.postMessage(msg, "*");
        }
        window.addEventListener("message", function (ev) {
            const data = ev.data;
            console.log("webview on message", data);
            const handler = onMessageHandlerMap[data.type];
            if (!handler) return;
            handler(data)
        });

        const onMessageHandlerMap = {
            init(data) {
                const inputEl = document.getElementsByName("targetFolder")[0];
                inputEl.value = data.data.fsPath;
            }
        }

    </script>
    <script>
        const utils = {
            getFormData(form) {
                const formData = new FormData(form);
                const object = {};
                formData.forEach(function (value, key) {
                    object[key] = value;
                });
                return object;
            },
            checkFormData(data) {

            }
        }

        const $ = document.querySelector.bind(document);
        const btnSubmit = $("#submit");
        const formEl = $("#form");

        btnSubmit.addEventListener("click", () => {
            const data = utils.getFormData(formEl);
            console.log("formData:", data);

            console.log(JSON.stringify(data))
        })

    </script>
</body>

</html>